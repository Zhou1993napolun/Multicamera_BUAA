原模型
batch_inputs
{'images': tensor([[[[ 73.,  71.,  70.,  ...,   0.,   0.,   0.],
          [ 73.,  72.,  72.,  ...,   0.,   0.,   0.],
          [ 74.,  73.,  74.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 73.,  71.,  70.,  ...,   0.,   0.,   0.],
          [ 73.,  72.,  72.,  ...,   0.,   0.,   0.],
          [ 74.,  73.,  74.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 73.,  71.,  70.,  ...,   0.,   0.,   0.],
          [ 73.,  72.,  72.,  ...,   0.,   0.,   0.],
          [ 74.,  73.,  74.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]],


        [[[ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          [ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          [ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          [ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          [ 35.,  33.,  31.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 37.,  35.,  33.,  ...,   0.,   0.,   0.],
          [ 37.,  35.,  33.,  ...,   0.,   0.,   0.],
          [ 37.,  35.,  33.,  ...,   0.,   0.,   0.],
          ...,
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]],


        [[[ 82.,  78.,  82.,  ...,   0.,   0.,   0.],
          [ 82.,  79.,  84.,  ...,   0.,   0.,   0.],
          [ 83.,  82.,  86.,  ...,   0.,   0.,   0.],
          ...,
          [ 87.,  86.,  93.,  ...,   0.,   0.,   0.],
          [ 88.,  87.,  94.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 85.,  81.,  85.,  ...,   0.,   0.,   0.],
          [ 85.,  82.,  87.,  ...,   0.,   0.,   0.],
          [ 86.,  85.,  89.,  ...,   0.,   0.,   0.],
          ...,
          [ 84.,  83.,  88.,  ...,   0.,   0.,   0.],
          [ 85.,  83.,  88.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]],

         [[ 64.,  60.,  64.,  ...,   0.,   0.,   0.],
          [ 64.,  61.,  66.,  ...,   0.,   0.,   0.],
          [ 65.,  63.,  68.,  ...,   0.,   0.,   0.],
          ...,
          [ 79.,  78.,  84.,  ...,   0.,   0.,   0.],
          [ 80.,  78.,  84.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.]]],


        ...,


        [[[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          ...,
          [  0., 149., 150.,  ..., 176., 176., 176.],
          [  0., 155., 156.,  ..., 174., 174., 173.],
          [  0., 161., 161.,  ..., 168., 167., 167.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          ...,
          [  0., 142., 143.,  ..., 167., 167., 167.],
          [  0., 147., 148.,  ..., 165., 165., 165.],
          [  0., 153., 153.,  ..., 160., 159., 158.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          ...,
          [  0., 134., 135.,  ..., 158., 158., 158.],
          [  0., 140., 140.,  ..., 156., 155., 155.],
          [  0., 145., 146.,  ..., 149., 149., 148.]]],


        [[[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ..., 114., 114., 114.],
          ...,
          [  0.,   0.,   0.,  ..., 152., 154., 155.],
          [  0.,   0.,   0.,  ..., 152., 154., 155.],
          [  0.,   0.,   0.,  ..., 152., 153., 154.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ..., 114., 114., 114.],
          ...,
          [  0.,   0.,   0.,  ..., 134., 134., 136.],
          [  0.,   0.,   0.,  ..., 133., 134., 136.],
          [  0.,   0.,   0.,  ..., 133., 133., 135.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ..., 114., 114., 114.],
          ...,
          [  0.,   0.,   0.,  ..., 124., 125., 127.],
          [  0.,   0.,   0.,  ..., 124., 125., 126.],
          [  0.,   0.,   0.,  ..., 123., 124., 126.]]],


        [[[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,  32.,  32.,  32.],
          [  0.,   0.,   0.,  ...,  32.,  32.,  32.],
          ...,
          [  0.,   0.,   0.,  ..., 146., 147., 147.],
          [  0.,   0.,   0.,  ..., 143., 144., 144.],
          [  0.,   0.,   0.,  ..., 141., 143., 143.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,  35.,  35.,  35.],
          [  0.,   0.,   0.,  ...,  35.,  35.,  35.],
          ...,
          [  0.,   0.,   0.,  ..., 139., 140., 140.],
          [  0.,   0.,   0.,  ..., 136., 137., 137.],
          [  0.,   0.,   0.,  ..., 134., 136., 136.]],

         [[  0.,   0.,   0.,  ...,   0.,   0.,   0.],
          [  0.,   0.,   0.,  ...,  40.,  40.,  39.],
          [  0.,   0.,   0.,  ...,  40.,  40.,  39.],
          ...,
          [  0.,   0.,   0.,  ..., 129., 130., 130.],
          [  0.,   0.,   0.,  ..., 126., 127., 127.],
          [  0.,   0.,   0.,  ..., 124., 126., 126.]]]], device='cuda:0'), 'targets': tensor([582, 582, 582, 582, 582, 582, 582, 582, 582, 582, 582, 582, 582, 582,
        582, 582, 578, 578, 578, 578, 578, 578, 578, 578, 578, 578, 578, 578,
        578, 578, 578, 578, 217, 217, 217, 217, 217, 217, 217, 217, 217, 217,
        217, 217, 217, 217, 217, 217, 157, 157, 157, 157, 157, 157, 157, 157,
        157, 157, 157, 157, 157, 157, 157, 157], device='cuda:0'), 'camids': tensor([0, 5, 1, 3, 4, 4, 1, 3, 1, 5, 5, 5, 2, 0, 4, 2, 5, 5, 2, 0, 3, 3, 3, 3,
        3, 3, 5, 2, 3, 5, 5, 4, 2, 2, 2, 2, 5, 2, 0, 5, 5, 4, 0, 5, 5, 5, 4, 2,
        1, 5, 5, 5, 4, 2, 1, 4, 2, 2, 0, 2, 5, 1, 0, 5], device='cuda:0'), 'img_paths': ['datasets/Market-1501-v15.09.15/bounding_box_train/0704_c1s3_069626_01.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c6s2_049543_06.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c2s2_052162_01.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c4s3_074285_03.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c5s2_059477_01.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c5s2_059577_04.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c2s2_056357_04.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c4s3_074310_03.jpg', 'datasets/Market-1501-v15.09.15/bounding_box_train/0704_c2s2_052112_01.jpg', ...]}

b1_outputs


自个测
batch_inputs
tensor([[[[-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          [-2.1179, -2.1179, -2.1179,  ..., -2.1179, -2.1179, -2.1179],
          ...,
          [-1.2103, -1.0390, -0.7993,  ..., -0.9192, -0.8678, -2.1179],
          [-1.3302, -1.1418, -0.8678,  ..., -0.8507, -0.7993, -2.1179],
          [-1.4329, -1.2274, -0.9534,  ..., -0.8164, -0.7479, -2.1179]],

         [[-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          [-2.0357, -2.0357, -2.0357,  ..., -2.0357, -2.0357, -2.0357],
          ...,
          [-1.1604, -0.9678, -0.7402,  ..., -0.8803, -0.8277, -2.0357],
          [-1.2654, -1.0553, -0.8102,  ..., -0.8102, -0.7577, -2.0357],
          [-1.3529, -1.1604, -0.8978,  ..., -0.7752, -0.7052, -2.0357]],

         [[-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          [-1.8044, -1.8044, -1.8044,  ..., -1.8044, -1.8044, -1.8044],
          ...,
          [-0.9853, -0.7761, -0.4798,  ..., -0.8110, -0.7587, -1.8044],
          [-1.1073, -0.8807, -0.5670,  ..., -0.7413, -0.6890, -1.8044],
          [-1.2119, -0.9678, -0.6541,  ..., -0.7064, -0.6367, -1.8044]]]],
       device='cuda:1')

b1_outputs
就一个tensor


目前训练的时候发现会cls head不匹配报错。报错原因为，当初每一个camera是用独立划分好的datasets独立训练的。
而目前我们用于eval和train的datasets是重新划分的。

ways：
1. 尝试放入一个cls token字典，对于超过边界的target cls，跳过。可以视为换数据微调，和之前eval的逻辑是一致的
2. 使用原数据划分，相对而言说服力则没有很强